---
title: 
- "STAT 341: Assignment 1 - Fall 2021"
author: "Instructor: Reza Ramezan"
date: 'Due: Friday, Sep. 24 at 10:00am EDT'
output:
  pdf_document: default
  html_document: default
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
```

```{r, include = FALSE}
library(knitr)
opts_chunk$set(tidy.opts=list(width.cutoff=60),tidy=TRUE)
```

## Instructions

Your assignment must be submitted by the due date listed at the top of this document. The assignments deadlines are firm and the late submission penalty outlined in the course syllabus starts at 10:01am on Sept. 24.

You must upload your solutions in the form of **one pdf file for each part of each question** by the deadline onto **Crowdmark**. Your instructor will NOT accommodate mistakes in submitting the pdf file of one question for another question. No assignment submission through email will be accepted. Note that your .pdf solution file must have been generated by R Markdown. Additionally:

* For mathematical questions: your solutions must be produced by LaTeX (from within R Markdown), unless specifically mentioned that hand-written solutions are accepted where you can import a clear image of a hand-written solution. If such note is not included, screenshots and scanned/photographed handwritten solutions receive zero points.

* For computational questions: R code should always be included in your solution (via code chunks in R Markdown). If code is required and you provide none, you will received zero points.

* For interpretation questions: plain text (within R Markdown) is required. Text responses embedded as comments within code chunks will not be accepted.

Organization and formatting is part of a full solution. Consequently, points will be deducted for solutions that are not organized and incomprehensible. A disorganized solution which is difficult to understand or find parts will not receive full marks. 

---

## Academic integrity: 

* While you may discuss the questions with your classmates on Piazza, consulting another student's solution is prohibited, and submitted solutions may not be copied from any source. You may not talk to any other individual about the questions in this assignment. The instructor will hold online office hours during which he will answer clarification questions. You also have access to Piazza where you can ask questions.


* You may not use and/or search the internet (except for LEARN and Piazza) to answer the questions in this assignment. However, you may search the internet for R syntax.

* If a question which you would like to post on Piazza shares your solution, you must make it a private post.


* In short, you can treat this assignment like an open-book exam, where you are only allowed to use the course material provided to you during lectures and on Piazza and/or LEARN as well as books you may find at the library.


* Any violation of the the academic integrity regulations outlined here and in the course syllabus (make sure you read the course outline again!) will be counted as cheating and will be reported to the Dean's Office.

* The instructor reserves the right to conduct an online interview with you during which you will be asked questions about your solutions and the details of how you came to these responses. Should such an interview take place and you are unable to explain and defend your solutions, your grade for this assignment, and consequently, your course grade will be affected.

---

## Question 1 [24 marks]

Excess kurtosis is an attribute to quantify the "tailedness" of a distribution relative to a Gaussian (i.e. Normal) distribution. This attribute is related to extreme values in the distribution, and is a measure about the tail. However, it is *mistakenly* referred to as a measure of "peakness" although kurtosis does not measure the peakness of a distribution. Consider the population $\mathcal{P} = \{y_1, \ldots, y_N\}$. Excess kurtosis is defined as 


$$\alpha(\mathcal{P}) = \frac{\frac{1}{N} \sum_{u \in \mathcal{P}}\left( y_u -\overline{y} \right)^4}{ \sigma^4 }-3 $$

where $\overline{y} = \frac{1}{N}\sum_{u \in \mathcal{P}}y_u$ and $\sigma^4 = [\frac{1}{N}\sum_{u \in \mathcal{P}}(y_u-\overline y)^2]^2$ are the population average, and the population variance squared, respectively. In this question you will investigate several properties of this attribute. You may assume without proof that the population average is location equivariant, scale equivariant, and replication invariant.

(a) **[3 marks]** Investigate if $\alpha(\mathcal P)$ is location invariant, location equivariant, or neither.

(b) **[3 marks]** Investigate if $\alpha(\mathcal P)$ is scale invariant, scale equivariant, or neither.

(c) **[3 marks]** Investigate if $\alpha(\mathcal P)$ is location-scale invariant, location-scale equivariant, or neither.

(d) **[3 marks]** Investigate if $\alpha(\mathcal P)$ is replication invariant, replication equivariant, or neither.

(e) **[3 marks]** If we replace $\sigma^4$ with $\sigma_*^4 = [\frac{1}{N-1}\sum_{u \in \mathcal{P}}(y_u-\overline y)^2]^2$ in the definition of $\alpha(\mathcal P)$, does your answer to parts (b) and (d) change? Provide the details of your response.

(f) **[2 mark]** Write the equation for the sensitivity curve of $\alpha(\mathcal P)$, given a population $\left\{y_1, y_2, \dots, y_{N-1} \right\}$. 

(g) **[3 marks]** For the population below, plot the sensitivity curve from part (f) for $y \in [-10,10]$. Make sure that you make the axes presentable, and include informative labels and titles. Based on this plot and all you have learned about the excess kurtosis in Question 1 so far, mention one good and one bad property of the excess kurtosis attribute.

```{r}
set.seed(341)
pop <- rt(1000,10) # t distribution with df=10
```


(h) **[4 marks]** Suppose $\gamma(\mathcal P)$ is a measure of dispersion/variation with the same units as the original data (standard deviation and inter-quartile range are some examples). Consider location, scale, and location-scale invariance/equivariance properties. Explain why each of these properties are desirable or undesirable for a measure of dispersion. 

$\;$
$\;$
$\;$
$\;$

---

## QUESTION 2 [25 marks]

The Iris data set of R. A. Fisher is perhaps the best known database to be found in the pattern recognition literature. The data set includes samples of 4 measurements for each of the 3 species of the iris plant. The file `iris.csv` includes the data and the descriptions of the variables are as follows. Each row in the data-set represents one sample.

Variate        | Description
-------------- |-----------------------------------------------------
`SepalLength`        | Sepal length in cm  
`SepalWidth`        | Sepal width in cm
`PetalLength`        | Petal length in cm
`PetalWidth`        | Petal width in cm
`Species`         | The type of the iris plant
 
  

(a) **[1 mark]** Load the data and output the number of rows and columns. 

(b) **[1 mark]** Using R, calculate the number of each iris species in the data. For presentation quality, consider using the `kable` command.  

(c) **[2 marks]** Using R, determine which iris species have  the largest and smallest sepal widths, respectively. 

(d) **[1 mark]** Using R, calculate and report the average  sepal length for each species of the iris flower. 

(e) Using R, add a new variable to the data called `PetalRatio = PetalWidth/PetalLength` and then determine 

    i) **[2 marks]** the iris species with the lasrgest and the smallest values of `PetalRatio`.

    ii) **[1 mark]** within each iris species, the proportion of samples with `PedalRatio` $>0.3$. 
    
(f) **[3 marks]** Using R, generate a scatterplot of the sepal length (y-axis) vs. the petal length (x-axis) while colouring the points based on the iris species (use three visible colours, e.g. black, red, and green). Make sure to add a legend and axis labels. Comment on the patterns you observe. 

(g) **[3 marks]** Using R, create a figure with 3 panels ($1\times 3$ plots). In each panel, generate the scatterplot of the petal length (y-axis) vs. the petal width (x-axis) of one species of iris. The title of each plot should be the iris species of that plot. Add to each plot a red point indicating the mean of the data in that plot. In particular, the x-coordinate and y-coordinate of the red dot should be, respectively, the mean petal length and the mean petal width of the particular iris species in that panel. Comment on any trends you observe in this plot.

(h) **[3 marks]** Using R, generate a scatterplot of sepal length (y-axis) vs iris species (x-axis). Add to this plot three red dots indicating the median sepal length of each iris species. Connect the medians (red dots) with red lines.

(i) Use power transformations for the following figures and plots. Make sure to appropriately title and label your plots.

Here is the `powerfun`  for convenience 

```{r}
powerfun <- function(x, alpha) {
  if(sum(x <= 0) > 1) stop("x must be positive")
  if (alpha == 0)
    log(x)
  else if (alpha > 0) {
    x^alpha
  } else -x^alpha
}
```

  - i) **[2 marks]** Using the `SepalLength` and `PetalRatio`, construct a $1\times 3$ figure containing the two individual histograms and the scatterplot of the two variables. 

  - ii) **[2 marks]** What power (the values of $\alpha$) makes the distribution of `SepalLength` approximately symmetric? Plot a histogram of the transformed variable.  

  - iii) **[2 marks]** What power (the values of $\alpha$) makes the distribution of `PetalRatio` approximately symmetric? Plot a histogram of the transformed variable.  

  - iv) **[2 marks]** What pair of powers (the values of $\alpha$) makes the scatter plot of `SepalLength` and `PetalRatio` approximately linear? Plot a scatter plot of the transformed variables.  


$\;$
$\;$
$\;$
$\;$

---

## QUESTION 3 [6 marks]

From the boxplot subsection on page 24 STAT 231 notes which are posted on LEARN.

A boxplot  (also called box and whisker plots) is a graphical attribute that summarizes a population of variates based on a five-number summary: the minimum, the maximum, the median, and the first and third quartiles.

When the number of groups is large or the sample sizes within groups are small, side-by-side boxplots (also called box and whisker plots) are a convenient way to display the data.

A boxplot gives a graphical summary about the shape of the distribution and is usually displayed vertically. The line inside the box corresponds to the median or second quartile $q_2$. The top edge of the box corresponds to the upper quartile $q_3$ and the lower edge of the box corresponds to the lower quartile, $q_1$. The so-called whiskers extend down and up from the box to a horizontal line. The lower line is placed at the smallest observed value that is larger than the value $q_1 - 1.5 \times IQR$ where $IQR = q_3 - q_1$ is the inter-quartile range.  The upper line is placed at the largest observed value that is smaller than the value $q_3 + 1.5 \times IQR$. Values beyond the whiskers (often called outliers) are plotted individually with special symbols.

Write a function called `drawBoxPlot` that takes in a single input that is labelled `df`, an $N \times m$ data frame containing *numeric* data. This function should produce a single figure with $m$ boxplots that share a common scale.

- Use the `boxplot.stats` to find the points for the figures. 
- Use the first 4 columns of the Iris data-set (length and width of sepals and petals) to demonstrate the `drawBoxPlot` function.


 
$\;$
$\;$
$\;$
$\;$


    